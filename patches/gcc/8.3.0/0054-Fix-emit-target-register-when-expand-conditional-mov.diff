From 0165c67198e4b7b3c4d5cceb985ffad362da2c48 Mon Sep 17 00:00:00 2001
From: Jinyang He <hejinyang@loongson.cn>
Date: Wed, 15 Nov 2023 15:52:13 +0800
Subject: [PATCH 13/15] Fix emit target register when expand conditional move

Change-Id: Iaced456c31ee8541042a602c5eef27292733e8b6
---
 src/gcc/config/loongarch/loongarch.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/gcc/config/loongarch/loongarch.c b/src/gcc/config/loongarch/loongarch.c
index f3e16a6b4..9aefe2953 100644
--- a/src/gcc/config/loongarch/loongarch.c
+++ b/src/gcc/config/loongarch/loongarch.c
@@ -4914,9 +4914,10 @@ loongarch_expand_conditional_move_la464 (rtx *operands)
 	  if(FLOAT_MODE_P(sel_mode)){
 		  rtx target = gen_reg_rtx (GET_MODE (op0));
 		  bool invert = false;
-		  loongarch_emit_int_order_test (LTU, NULL, op0,
+		  loongarch_emit_int_order_test (LTU, NULL, target,
 				  force_reg (GET_MODE (op0), const0_rtx),
 				  op0);
+		  op0 = target;
 		  op1 = const0_rtx;
 	  }
 	}
-- 
2.39.3

